<!DOCTYPE html>
<html>
 <head>
   <meta name="viewport"
         content="width=device-width,
                  initial-scale=1">
   <meta charset="UTF-8">
   <title>a very occasional diary @ Nikita Danilov | Деревья по кругу.</title>
   <link rel="stylesheet" href="style.css">
   <link rel="alternate"
         type="application/rss+xml"
         title="Occasional diary"
         href="https://cofault.com/feed.xml">
   <style></style>
   <script async src="https://www.googletagmanager.com/gtag/js?id=G-WEM34DWDR2"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WEM34DWDR2');
</script>
   
        <script>window.MathJax = {
                loader: {load     : ['[tex]/amscd']},
                tex:    {packages : {'[+]': ['amscd']}}
        };
        </script>
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 </head>
 <body>
   <a name="деревья"></a>
<div class="column"><header>Деревья по кругу.</header>
<a name="деревья-00000"></a><p style="margin-left: 3em;"><i>Abstract</i>: orbits of an endomorphism of a finite set are represented as  connected components of a suitably defined graph. Their structure is  surprisingly simple: a collection of disjoint trees rooted on the vertices of a  unique cycle.</p>
<a name="деревья-00001"></a><p>Пусть \(f:X\rightarrow X\), произвольное отображение множества \(X\) в себя, т.е. <a href="http://en.wikipedia.org/wiki/Endomorphism">эндоморфизм</a> \(X\). Известно, что если \(f\) является <a href="http://en.wikipedia.org/wiki/Automorphism">автоморфизмом</a> (т.е. <a href="http://en.wikipedia.org/wiki/Bijective_map">биекцией</a>), то оно разбивает \(X\) на непересекающиеся <a href="http://en.wikipedia.org/wiki/Orbit_(group_theory)#Orbits_and_stabilizers">орбиты</a>. Каждая орбита состоит из точек</p>
<a name="деревья-00002"></a>$$\ldots f^{-2}(x), f^{-1}(x), x, f(x), f^2(x), \ldots$$
<a name="деревья-00003"></a><p>для некоторого \(x\), где \(f^n\) означает \(n\)-кратное применение \(f\) (\(f^0(x) = x\), \(f^{n+1}(x) = f(f^n(x))\), \(f^{-n}(x) = (f^{-1})^n(x)\)). Если \(X\) конечно, то всякая орбита является <i>циклом</i>, состоящим из конечного числа точек, и для некоторого \(n\) будет \(x = f^{n}(x)\). В случае бесконечного \(X\) могут существовать орбиты, состоящие из бесконечного (счетного) числа различных точек.</p>
<a name="деревья-00004"></a><p>Как выглядят аналоги орбит для произвольных эндоморфизмов конечных множеств?</p>
<a name="деревья-00005"></a><p>Обычное определение орбиты не дает интересного обобщения на эндоморфизмы, т.к. получающися множества пересекаются. Вместо этого, дадим следующее определение:</p>
<a name="деревья-00006"></a><p style="margin-left: 3em;">Множество \(M\), \(M \subseteq X\), \(f\)-замкнуто, если \(x \in M\equiv  f(x)\in M\), т.е. \(f\)-замкнутое множество содержит вместе с каждой точкой  \(x\) ее образ \(f(x)\) и все прообразы \(f^{-1}(x)\).</p>
<a name="деревья-00007"></a><p>Очевидно, что</p>
<a name="деревья-00008"></a><p style="margin-left: 3em;">Пересечение \(f\)-замкнутых множеств \(M\) и \(N\) — \(f\)-замкнуто:</p>
<a name="деревья-00009"></a><p style="margin-left: 6em;">\(x\in M \cap N\)</p>
<a name="деревья-00010"></a><p style="margin-left: 6em;">\(\equiv\) { определение пересечения множеств }</p>
<a name="деревья-00011"></a><p style="margin-left: 6em;">\(x\in M \wedge x\in N\)</p>
<a name="деревья-00012"></a><p style="margin-left: 6em;">\(\equiv\){ определение \(f\)-замкнутости}</p>
<a name="деревья-00013"></a><p style="margin-left: 6em;">\(f(x)\in M \wedge f(x)\in N\)</p>
<a name="деревья-00014"></a><p style="margin-left: 6em;">\(\equiv\){ определение пересечения множеств }</p>
<a name="деревья-00015"></a><p style="margin-left: 6em;">\(f(x)\in M \cap N\)</p>
<a name="деревья-00016"></a><p>Орбитой называется непустое минимальное \(f\)-замкнутое множество, т.е. \(f\)-замкнутое множество не имеющее собственных \(f\)-замкнутых подмножеств.  Для автоморфизмов это определение совпадает со стандартным.</p>
<a name="деревья-00017"></a><p>Очевидно, что орбиты не пересекаются (иначе их пересечение было бы их \(f\)-замкнутым подмножеством, в нарушение требования минимальности). Кроме этого, всякая точка принадлежит хотя бы одному \(f\)-замкнутому множеству, например всему \(X\). Это значит, что для всякой точки определено пересечение всех \(f\)-замкнутых множеств, содержащих эту точку. Такое пересечение будет орбитой. Следовательно \(X\) разбивается на непересекающиеся орбиты.</p>
<a name="деревья-00018"></a><h3>Граф</h3>
<a name="деревья-00019"></a><p>Отображению \(f\) можно сопоставить ориентированный граф (который останется безымянным, как единственный, подлежащий рассмотрению), с множеством вершин \(X\) и множеством дуг \(\{(x, f(x)) | x \in X \}\).</p>
<a name="деревья-00020"></a><p>Этот граф обладает замечательным свойством: у каждой его вершины есть ровно одна исходящая дуга. Очевидно, что всякому графу, обладающему таким свойством соответствует эндоморфизм множества вершин.</p>
<a name="деревья-00021"></a><p>Мы будет также рассматривать неориентированную версию этого же графа (в которой забыты направление дуг) и будем в этом случае говорить о &quot;ребрах&quot; (а не дугах), неориентированнх путях и неориентированных циклах.</p>
<a name="деревья-00022"></a><p>Все пути и циклы предполагаются простыми, т.е. проходящими через данную дугу или вершину не более одного раза, если не оговорено противное.</p>
<a name="деревья-00023"></a><p>Переформулировав определение орбиты в терминах неориентированного графа, получаем, что пара связанных ребром вершин принадлежит одной и той же орбите. Отсюда следует, что орбиты это в точности <a href="http://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82%D0%B0_%D1%81%D0%B2%D1%8F%D0%B7%D0%BD%D0%BE%D1%81%D1%82%D0%B8_%D0%B3%D1%80%D0%B0%D1%84%D0%B0">компоненты связности</a> неориентированного графа.</p>
<a name="деревья-00024"></a><p>Рассмотрим дугу \(a\) из вершины \(x\) в вершину \(y\) (т.е. предположим, что \(y = f(x)\)). Для соответствующего ребра \(a\) определим</p>
<a name="деревья-00025"></a>$$\begin{array}{r@{\;}c@{\;}l@{\quad}}
       \sigma(x, a) &amp;\;=\;&amp;  0,\quad \text{если \(x = y\), иначе} \\
       \sigma(x, a) &amp;\;=\;&amp; +1 \\
       \sigma(y, a) &amp;\;=\;&amp; -1
\end{array}$$
<a name="деревья-00026"></a><p>Таким образом, функция \(\sigma\) определена для любой вершины и смежного ей ребра и обладает следующими свойствами:</p>
<a name="деревья-00027"></a><p style="margin-left: 3em;">Если ребро \(a\) соединяет вершины \(x\) и \(y\), то \(\sigma(x, a) + \sigma(y,  a) = 0\) (свойство (0))</p>
<a name="деревья-00028"></a><p style="margin-left: 3em;">Если вершина \(x\) соединяет ребра \(a\) и \(b\), то \(\sigma(x, a) + \sigma(x,  b) \leq 0\) (свойство (1))</p>
<a name="деревья-00029"></a><p>Теперь мы может доказать простую лемму:</p>
<a name="деревья-00030"></a><p style="margin-left: 3em;">Если \(a_0, ... a_n\) неориентированный путь между вершинами \(x\) и \(y\), то  \(\sigma(x, a_0) + \sigma(y, a_n) &gt; -2\), т.е. крайние ребра пути не могут  быть одновременно входящими.</p>
<a name="деревья-00031"></a><p style="margin-left: 3em;">Индукция по длине пути.</p>
<a name="деревья-00032"></a><p style="margin-left: 6em;">\(n = 1\). Немедленно по свойству (0).</p>
<a name="деревья-00033"></a><p style="margin-left: 6em;">\(n = k + 1\). Пусть \(a_0, ... a_k\) неориентированный путь между вершинами   \(x\) и \(z\), а ребро \(a_{k+1}\) соединяет \(z\) и \(y\).</p>
<a name="деревья-00034"></a>$$\begin{array}{r@{\;}l@{\quad}}
       &amp; \sigma(x, a_0) + \sigma(y, a_{k+1}) \\
  \;=\;&amp; \sigma(x, a_0) + \sigma(y, a_{k+1}) + \sigma(z, a_k) - \sigma(z, a_k) \\
  \;&gt;\;&amp; \text{ \{ по гипотезе индукции \(\sigma(x, a_0) + \sigma(z, a_k) &gt; -2\) \} } \\
       &amp; -2 + \sigma(y, a_{k+1}) - \sigma(z, a_k) \\
  \;=\;&amp; -2 + \sigma(y, a_{k+1}) - \sigma(z, a_k) + \sigma(z, a_{k+1}) - \sigma(z, a_{k+1}) \\
  \;\geq\;&amp; \text{ \{ по свойству (1) \(\sigma(z, a_k) + \sigma(z, a_{k+1}) \leq 0\) \} } \\
       &amp; -2 + \sigma(y, a_{k+1}) + \sigma(z, a_{k+1}) \\
  \;=\;&amp; \text{ \{ по свойству (0) \(\sigma(y, a_{k+1}) + \sigma(z, a_{k+1}) = 0\) \} } \\ 
  \;=\;&amp; -2 \\
\end{array}$$
<a name="деревья-00035"></a><h3>Циклы</h3>
<a name="деревья-00036"></a><p>Рассмотрим ориентированные циклы в нашем графе. Для всякой вершины \(x\), лежащей на ориентированном цикле из \(n\) вершин \((x_i | 0 \leq i &lt; n)\), имеем \(f^n(x) = x\). В частности, циклы длины 1 это в точности стационарные точки \(f\).  Обратно, множество вершин всякого ориентированного цикла длины \(n\) можно описать как</p>
<a name="деревья-00037"></a>$$\{f^i(x) | 0 \leq i &lt; n\} = \{f^i(x) | 0 \leq i\} = \{x, f(x), \ldots, f^{n-1}(x)\}$$
<a name="деревья-00038"></a><p>где за \(x\) можно принять любую вершину цикла.</p>
<a name="деревья-00039"></a><p>При помощи функции \(\sigma\) легко доказывается и следующий полезный факт:</p>
<a name="деревья-00040"></a><p style="margin-left: 3em;"><i>Всякий цикл ориентирован</i>.</p>
<a name="деревья-00041"></a><p style="margin-left: 3em;">Рассмотрим неориентированный цикл из ребер \(a_i\), соединяющих вершины \(x_i\)  и \(x_{i+1}\), где \(0 \leq i &lt; n\) и \(i+1\) понимается по модулю \(n\).  Составим сумму</p>
<a name="деревья-00042"></a>$$S = \sum_{0 \leq i &lt; n}\sigma(x_i, a_i) + \sigma(x_{i+1}, a_i)$$
<a name="деревья-00043"></a><p style="margin-left: 3em;">По свойству (0), каждое слагаемое этой суммы равно 0. Перегруппировав слагаемые, получим</p>
<a name="деревья-00044"></a>$$S = \sum_{0 \leq i &lt; n}\sigma(x_i, a_i) + \sigma(x_i, a_{i-1}) = 0$$
<a name="деревья-00045"></a><p style="margin-left: 3em;">По свойству (1), каждое слагаемое здесь не больше нуля. Так как сумма равно 0,  то каждое слагаемое равно 0:</p>
<a name="деревья-00046"></a>$$\sigma(x_i, a_i) + \sigma(x_i, a_{i-1}) = 0$$
<a name="деревья-00047"></a><p style="margin-left: 3em;">Т.е., в каждую вершину цикла входит и выходит одна дуга, то есть цикл  ориентирован.</p>
<a name="деревья-00048"></a><p>С этого момента не будет различать ориентированные и неориентированные циклы.</p>
<a name="деревья-00049"></a><p>Просто доказывается следующее свойство:</p>
<a name="деревья-00050"></a><p style="margin-left: 3em;"><i>Циклы имеющие общую вершину совпадают</i>.</p>
<a name="деревья-00051"></a><p style="margin-left: 3em;">Действительно, пусть циклы \(\{f^i(x) | 0 \leq i\}\) и \(\{f^i(y) | 0 \leq i\}\) имеют общую точку. Т.е. \(f^p(x) = f^q(y)\). Для произвольной точки первого цикла имеем</p>
<a name="деревья-00052"></a>$$\begin{array}{r@{\;}l@{\quad}}
       &amp; f^i(x) \\
  \;=\;&amp; \text{ \{ для произвольного \(d\), так как \(f^n(x) = x\) \} } \\
       &amp; f^{i+ d\cdot n}(x) \\
  \;\geq\;&amp; \text{ \{ выберем \(d\) так, что \(i+ d\cdot n &gt; p\) \} } \\
  \;=\;&amp; f^{p + \Delta}(x) \\
  \;=\;&amp; f^\Delta(f^p(x)) \\
  \;=\;&amp; \text{ \{ \(f^p(x) = f^q(y)\) \} }\\
       &amp; f^{q +\Delta}(y) \in \{f^i(y) | 0 \leq i\}
\end{array}$$
<a name="деревья-00053"></a><p>Аналогично, всякая точка второго цикла принадлежит первому.</p>
<a name="деревья-00054"></a><p>Отсюда следует интересное свойство:</p>
<a name="деревья-00055"></a><p style="margin-left: 3em;">Всякий неориентированный путь \(P\) между вершинами \(x\) и \(y\), лежащими на  циклах, полностью лежит в некотором цикле.</p>
<a name="деревья-00056"></a><p style="margin-left: 3em;">Применим индукцию  по длине \(P\).</p>
<a name="деревья-00057"></a><p style="margin-left: 6em;">\(n = 0\). Очевидно.</p>
<a name="деревья-00058"></a><p style="margin-left: 6em;">\(n = k + 1\). По лемме, хотя бы одно из крайних ребер \(P\) —   исходящее. Пусть это ребро, исходящее из точки \(x\). Это ребро соединяет   \(x\) с вершиной \(f(x)\), также лежащей на цикле. Таким образом, путь \(f(x),   \ldots, y\) длины \(k\) соединяет точки, лежащие на циклах и следовательно (по   гипотезе индукции), полностью лежит в некотором цикле. Этот цикл имеет общую   точку \(f(x)\) с циклом в котором лежит точка \(x\) и, следовательно, эти   циклы совпадают. Таким образом, путь \(x, \ldots, y\) полностью лежит в цикле.</p>
<a name="деревья-00059"></a><p>Таким образом, два разных цикла не могут быть соединены путем. Следовательно, каждая орбита содержит не более одного цикла.</p>
<a name="деревья-00060"></a><p>Настало время использовать конечность \(X\).</p>
<a name="деревья-00061"></a><p style="margin-left: 3em;"><i>Всякая орбита конечного множества содержит цикл</i>.</p>
<a name="деревья-00062"></a><p style="margin-left: 3em;">Действительно, орбита \(M\) не пуста по определению. Выберем в ней точку \(x\) и рассмотрим функцию \(\phi : \mathbb{N} \rightarrow M\), \(\phi(n) = f^n(x)\). Т.к. \(M\) конечно, \(\phi\) не может быть однозначным отображением и существуют натуральные числа \(p\) и \(q\), такие что \(f^p(x) = f^q(x)\). Следовательно, \(f^p(x)\) лежит на цикле длины не большей \(|p - q|\).</p>
<a name="деревья-00063"></a><p>Зафиксируем орбиту и ее единственный цикл.</p>
<a name="деревья-00064"></a><p>Рассмотрим &quot;прореженный&quot; граф, получающийся из орбиты уделением всех ребер цикла и выберем компоненту связности этого графа, содержащую произвольную вершину на цикле.</p>
<a name="деревья-00065"></a><p>Очевидно, что</p>
<a name="деревья-00066"></a><p style="margin-left: 3em;">это множество не содержит других точек цикла, так как по свойству,  установленному выше, всякий путь соединяющий точки цикла лежит в этом цикле, а  ребра цикла были удалены;</p>
<a name="деревья-00067"></a><p style="margin-left: 3em;">это множество не содержит циклов, т.к. цикл в компоненте единственный и его  ребра удалены.</p>
<a name="деревья-00068"></a><p>Итак, компонента является связным (по построению) графом без циклов, т.е. <a href="http://ru.wikipedia.org/wiki/%D0%94%D0%B5%D1%80%D0%B5%D0%B2%D0%BE_(%D1%82%D0%B5%D0%BE%D1%80%D0%B8%D1%8F_%D0%B3%D1%80%D0%B0%D1%84%D0%BE%D0%B2)">деревом</a>, пересекающимся с циклом ровно в одной точке, которую можно выбрать за корень. Каждой точке цикла соответствует такое дерево. Деревья, соответствующие разным точкам цикла не пересекаются (как компоненты связности).</p>
<a name="деревья-00069"></a><p>Докажем, что всякая точка \(x\) орбиты принадлежит такому дереву. Для этого достаточно показать, что \(x\) можно соединить с некоторой вершиной цикла неориентированным путем не проходящим через ребра цикла (т.е. неориентированным путем пролегающем в прореженном графе) Т.к. орбита связна, то существует неориентированный путь \(P\), соединяющий \(x\) с вершиной цикла. Если этот путь содержит ребро цикла \(a\), то он распадается в композицию путей \(P = P_0\cdot a\cdot Q_0\). \(P_0\) соединяет \(x\) с одной из точек, соединенных ребром \(a\), т.е. с некоторой точкой на цикле. Повторяя процесс этот процесс необходимое число раз мы получим путь \(P_n\), который не содержит ребер цикла (возможно вообще не содержит ребер).</p>
<a name="деревья-00070"></a><p>Итак, орбита эндоморфизма конечного множества распадается на непересекающиеся деверья, корни которых прикреплены к циклу.</p>
<a name="деревья-00071"></a><p>Под действием последовательного применения преобразования \(f\), всякая точка сначала движется по дереву, в направлении корня, сливаясь при этом с другими точками этого дерева. После достижения корня, точка начинает двигаться по циклу.</p>
<a name="деревья-00072"></a><h3>Бесконечность</h3>
<a name="деревья-00073"></a><p>В случае бесконечного множества, орбита может быть устроена несколько сложнее.</p>
<a name="деревья-00074"></a><p>Вместо циклов, придется рассмотреть <i>траектории</i>, определенные, как последовательности точек \((f^n(x) | n &gt; 0)\). Цикл является частным случаем траектории.</p>
<a name="деревья-00075"></a><p>Так же как и в случае с циклами, неориентированный путь, соединяющий точки на траекториях, сам лежит в некоторой траектории. Однако траектории имеющие общую точку не обязаны совпадать. К счастью, имеется более слабое, но полезное свойство: если пересечение траекторий непусто, то оно является траекторией.</p>
<a name="деревья-00076"></a><p>Как и в конечном случае, рассмотрим компоненту связности. Возьмем пересечение всех содержащихся в ней траекторий. Предположим, что оно непусто. В таком случае, это перечение есть траектория. Образуем прореженный граф, удалив все ребра траектории-пересечения. Так как мы удалили как минимум по ребру из каждой траектории, то в рассматриваемой компоненте связности не осталось ни одной траектории, в частности, ни одного цикла. Неориентированная компонента связности прореженного графа является таким образом, связным ацикличным графом, т.е. деревом.</p>
<a name="деревья-00077"></a><p>Итак, в случае непустого пересечения траекторий, орбита распадается на непересекающиеся деревья, корни которых закреплены на траектории-пересечении.</p>
<a name="деревья-00078"></a><p>Остается рассмотреть случай пустого пересечения. Пример такой ситуации доставляет функция</p>
<a name="деревья-00079"></a>$$f:\mathbb{N}\times\mathbb{N}\rightarrow\mathbb{N}\times\mathbb{N}$$
<a name="деревья-00080"></a>$$f(x, y) = (\lfloor x/2^y\rfloor\cdot 2^y, y+1)$$
<a name="деревья-00081"></a><p>\(f\) строит бесконечное &quot;дерево&quot;, начиная с листьев, склеивая \(2^y\) смежных узлов уровня \(y\) в один узел уровня \(y+1\).  Очевидно, что все множество \(\mathbb{N}\times\mathbb{N}\) является орбитой. Каждая траектория через конечное число шагов достигает оси \(x = 0\), следовательно все траектории пересекаются, но их пересечение пусто.</p>
<a name="деревья-00082"></a><p>Однако здесь бессоница отступает и авторы прекращают дозволенные речи.</p><footer><a href="грозный.html#грозный">&lt;</a>&nbsp;<a href="series_blog_compact_reverse_flat.html">blog</a>&nbsp;<a href="электричество.html#электричество">&gt;</a>&nbsp;&nbsp;&nbsp;<a href="macro.html#macro">&lt;</a>&nbsp;<a href="series_timeline_compact_reverse_flat.html">timeline</a>&nbsp;<a href="zero-overrated.html#zero-overrated">&gt;</a>&nbsp;&nbsp;&nbsp;</footer></div>
 </body>
</html>
